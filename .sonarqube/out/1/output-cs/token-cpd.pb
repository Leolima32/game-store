–É
WC:\projects\repos\GameStore\src\4 - Infra\GameStore.Infra.Data\Context\DbInitializer.cs
	namespace 	
	GameStore
 
. 
Infra 
. 
Data 
. 
Context &
{ 
public 

static 
class 
DbInitializer %
{ 
public 
static 
async 
Task  

Initialize! +
(+ ,
GameStoreContext, <
context= D
,D E
IConfigurationF T
ConfigurationU b
,b c
UserManager 
< 
IdentityUser  
>  !
_userManager" .
,. /
RoleManager0 ;
<; <
IdentityRole< H
>H I
_roleManagerJ V
)V W
{ 	
if 
( 
context 
. 
Games 
. 
Any !
(! "
)" #
)# $
{ 
return 
; 
} 
context 
. 
Database 
. 
EnsureDeleted *
(* +
)+ ,
;, -
context 
. 
Database 
. 
EnsureCreated *
(* +
)+ ,
;, -
var 
role1 
= 
new 
IdentityRole (
(( )
)) *
{+ ,
Name- 1
=2 3
$str4 ;
}< =
;= >
var 
role2 
= 
new 
IdentityRole (
(( )
)) *
{+ ,
Name- 1
=2 3
$str4 >
}? @
;@ A
await 
_roleManager 
. 
CreateAsync *
(* +
role1+ 0
)0 1
;1 2
await   
_roleManager   
.   
CreateAsync   *
(  * +
role2  + 0
)  0 1
;  1 2
var"" 
user1"" 
="" 
new"" 
IdentityUser"" (
(""( )
)"") *
{""+ ,
UserName""- 5
=""6 7
$str""8 ?
,""? @
Email""A F
=""G H
$str""I Z
}""[ \
;""\ ]
var## 
user2## 
=## 
new## 
IdentityUser## (
(##( )
)##) *
{##+ ,
UserName##- 5
=##6 7
$str##8 H
,##H I
Email##J O
=##P Q
$str##R o
}##p q
;##q r
var$$ 
user3$$ 
=$$ 
new$$ 
IdentityUser$$ (
($$( )
)$$) *
{$$+ ,
UserName$$- 5
=$$6 7
$str$$8 >
,$$> ?
Email$$@ E
=$$F G
$str$$H b
}$$c d
;$$d e
var%% 
user4%% 
=%% 
new%% 
IdentityUser%% (
(%%( )
)%%) *
{%%+ ,
UserName%%- 5
=%%6 7
$str%%8 G
,%%G H
Email%%I N
=%%O P
$str%%Q i
}%%j k
;%%k l
await'' 
_userManager'' 
.'' 
CreateAsync'' *
(''* +
user1''+ 0
,''0 1
$str''2 =
)''= >
;''> ?
await(( 
_userManager(( 
.(( 
CreateAsync(( *
(((* +
user2((+ 0
,((0 1
$str((2 @
)((@ A
;((A B
await)) 
_userManager)) 
.)) 
CreateAsync)) *
())* +
user3))+ 0
,))0 1
$str))2 <
)))< =
;))= >
await** 
_userManager** 
.** 
CreateAsync** *
(*** +
user4**+ 0
,**0 1
$str**2 <
)**< =
;**= >
await++ 
_userManager++ 
.++ 
AddToRoleAsync++ -
(++- .
user1++. 3
,++3 4
$str++5 <
)++< =
;++= >
await,, 
_userManager,, 
.,, 
AddToRoleAsync,, -
(,,- .
user2,,. 3
,,,3 4
$str,,5 ?
),,? @
;,,@ A
await-- 
_userManager-- 
.-- 
AddToRoleAsync-- -
(--- .
user3--. 3
,--3 4
$str--5 ?
)--? @
;--@ A
await.. 
_userManager.. 
... 
AddToRoleAsync.. -
(..- .
user4... 3
,..3 4
$str..5 ?
)..? @
;..@ A
var00 
	companies00 
=00 
new00 
Company00  '
[00' (
]00( )
{11 
new22 
Company22 
(22 
new22 
CompanyName22  +
(22+ ,
$str22, 9
)229 :
,22: ;
new22; >
DateTime22? G
(22G H
$num22H L
,22L M
$num22M N
,22N O
$num22O Q
)22Q R
)22R S
,22S T
new33 
Company33 
(33 
new33 
CompanyName33  +
(33+ ,
$str33, <
)33< =
,33= >
new33> A
DateTime33B J
(33J K
$num33K O
,33O P
$num33P R
,33R S
$num33S T
)33T U
)33U V
,33V W
new44 
Company44 
(44 
new44 
CompanyName44  +
(44+ ,
$str44, 5
)445 6
,446 7
new448 ;
DateTime44< D
(44D E
$num44E I
,44I J
$num44J K
,44K L
$num44L M
)44M N
)44O P
,44P Q
new55 
Company55 
(55 
new55 
CompanyName55  +
(55+ ,
$str55, <
)55< =
,55= >
new55? B
DateTime55C K
(55K L
$num55L P
,55P Q
$num55Q R
,55R S
$num55S T
)55T U
)55U V
,55V W
new66 
Company66 
(66 
new66 
CompanyName66  +
(66+ ,
$str66, >
)66> ?
,66? @
new66A D
DateTime66E M
(66M N
$num66N R
,66R S
$num66S T
,66T U
$num66U V
)66V W
)66W X
,66X Y
new77 
Company77 
(77 
new77 
CompanyName77  +
(77+ ,
$str77, <
)77< =
,77= >
new77> A
DateTime77B J
(77J K
$num77K O
,77O P
$num77P Q
,77Q R
$num77R T
)77T U
)77U V
,77V W
new88 
Company88 
(88 
new88 
CompanyName88  +
(88+ ,
$str88, 6
)886 7
,887 8
new889 <
DateTime88= E
(88E F
$num88F J
,88J K
$num88K L
,88L M
$num88M O
)88O P
)88P Q
,88Q R
new99 
Company99 
(99 
new99 
CompanyName99  +
(99+ ,
$str99, 6
)996 7
,997 8
new999 <
DateTime99= E
(99E F
$num99F J
,99J K
$num99K L
,99L M
$num99M O
)99O P
)99P Q
,99Q R
new:: 
Company:: 
(:: 
new:: 
CompanyName::  +
(::+ ,
$str::, 4
)::4 5
,::5 6
new::7 :
DateTime::; C
(::C D
$num::D H
,::H I
$num::I J
,::J K
$num::K M
)::M N
)::N O
,::O P
new;; 
Company;; 
(;; 
new;; 
CompanyName;;  +
(;;+ ,
$str;;, :
);;: ;
,;;; <
new;;< ?
DateTime;;@ H
(;;H I
$num;;I M
,;;M N
$num;;N O
,;;O P
$num;;P R
);;R S
);;S T
}<< 
;<< 
foreach== 
(== 
Company== 
s== 
in== !
	companies==" +
)==+ ,
{>> 
context?? 
.?? 
	Companies?? !
.??! "
Add??" %
(??% &
s??& '
)??' (
;??( )
}@@ 
varBB 
	platformsBB 
=BB 
newBB 
PlatformBB  (
[BB( )
]BB) *
{CC 
newDD 
PlatformDD 
(DD 
$strDD ,
)DD, -
,DD- .
newEE 
PlatformEE 
(EE 
$strEE '
)EE' (
,EE( )
newFF 
PlatformFF 
(FF 
$strFF !
)FF! "
,FF" #
newGG 
PlatformGG 
(GG 
$strGG .
)GG. /
}HH 
;HH 
foreachII 
(II 
PlatformII 
sII 
inII  "
	platformsII# ,
)II, -
{JJ 
contextKK 
.KK 
	PlatformsKK !
.KK! "
AddKK" %
(KK% &
sKK& '
)KK' (
;KK( )
}LL 
varNN 
genresNN 
=NN 
newNN 
GenreNN "
[NN" #
]NN# $
{OO 
newPP 
GenrePP 
(PP 
$strPP 
)PP  
,PP  !
newQQ 
GenreQQ 
(QQ 
$strQQ "
)QQ" #
,QQ# $
newRR 
GenreRR 
(RR 
$strRR #
)RR# $
,RR$ %
newSS 
GenreSS 
(SS 
$strSS $
)SS$ %
,SS% &
newTT 
GenreTT 
(TT 
$strTT "
)TT" #
,TT# $
newUU 
GenreUU 
(UU 
$strUU  
)UU  !
,UU! "
newVV 
GenreVV 
(VV 
$strVV 
)VV  
,VV  !
newWW 
GenreWW 
(WW 
$strWW #
)WW# $
,WW$ %
newXX 
GenreXX 
(XX 
$strXX %
)XX% &
}YY 
;YY 
foreachZZ 
(ZZ 
GenreZZ 
sZZ 
inZZ 
genresZZ  &
)ZZ& '
{[[ 
context\\ 
.\\ 
Genres\\ 
.\\ 
Add\\ "
(\\" #
s\\# $
)\\$ %
;\\% &
}]] 
var__ 
games__ 
=__ 
new__ 
Game__  
[__  !
]__! "
{`` 
newaa 
Gameaa 
(aa 
$straa +
,aa+ ,
$strbb N
+cc 
$strcc `
+dd 
$strdd b
+ee 
$stree J
,eeJ K
$strff e
,ffe f
EDepartmentgg 
.gg 
Gamegg  
,gg  !
$numgg" '
,gg' (
newgg) ,
DateTimegg- 5
(gg5 6
$numgg6 :
,gg: ;
$numgg; =
,gg= >
$numgg> ?
)gg? @
,gg@ A
$numggB D
)ggD E
,ggE F
newii 
Gameii 
(ii 
$strii -
,ii- .
$strjj O
+kk 
$strkk e
+ll 
$strll h
+mm 
$strmm (
,mm( )
$strnn ^
+oo 
$stroo H
,ooH I
EDepartmentooJ U
.ooU V
GameooV Z
,ooZ [
$numoo\ a
,ooa b
newooc f
DateTimeoog o
(ooo p
$numoop t
,oot u
$numoou v
,oov w
$numoow y
)ooy z
,ooz {
$numoo| }
)oo} ~
,oo~ 
newqq 
Gameqq 
(qq 
$strqq )
,qq) *
$strrr Q
+ss 
$strss T
+tt 
$strtt P
+uu 
$struu @
,uu@ A
$strvv X
,vvX Y
EDepartmentww 
.ww 
Gameww  
,ww  !
$numww" '
,ww' (
newww) ,
DateTimeww- 5
(ww5 6
$numww6 :
,ww: ;
$numww; <
,ww< =
$numww= ?
)ww? @
,ww@ A
$numwwB C
)wwC D
,wwD E
newyy 
Gameyy 
(yy 
$stryy B
,yyB C
$strzz L
+{{ 
$str{{ J
+|| 
$str|| G
+}} 
$str}} 4
,}}4 5
$str~~ T
+ 
$str j
,j k
EDepartment
ÄÄ 
.
ÄÄ 
Game
ÄÄ  
,
ÄÄ  !
$num
ÄÄ" (
,
ÄÄ( )
new
ÄÄ* -
DateTime
ÄÄ. 6
(
ÄÄ6 7
$num
ÄÄ7 ;
,
ÄÄ; <
$num
ÄÄ< =
,
ÄÄ= >
$num
ÄÄ> @
)
ÄÄ@ A
,
ÄÄA B
$num
ÄÄC D
)
ÄÄD E
,
ÄÄE F
}
ÅÅ 
;
ÅÅ 
games
ÉÉ 
[
ÉÉ 
$num
ÉÉ 
]
ÉÉ 
.
ÉÉ 
ChangeImagePath
ÉÉ $
(
ÉÉ$ %
$str
ÉÉ% 7
)
ÉÉ7 8
;
ÉÉ8 9
games
ÑÑ 
[
ÑÑ 
$num
ÑÑ 
]
ÑÑ 
.
ÑÑ "
ChangeCoverImagePath
ÑÑ )
(
ÑÑ) *
$str
ÑÑ* A
)
ÑÑA B
;
ÑÑB C
games
ÖÖ 
[
ÖÖ 
$num
ÖÖ 
]
ÖÖ 
.
ÖÖ 
ChangeImagePath
ÖÖ $
(
ÖÖ$ %
$str
ÖÖ% 7
)
ÖÖ7 8
;
ÖÖ8 9
games
ÜÜ 
[
ÜÜ 
$num
ÜÜ 
]
ÜÜ 
.
ÜÜ "
ChangeCoverImagePath
ÜÜ )
(
ÜÜ) *
$str
ÜÜ* A
)
ÜÜA B
;
ÜÜB C
games
áá 
[
áá 
$num
áá 
]
áá 
.
áá 
ChangeImagePath
áá $
(
áá$ %
$str
áá% ?
)
áá? @
;
áá@ A
games
àà 
[
àà 
$num
àà 
]
àà 
.
àà "
ChangeCoverImagePath
àà )
(
àà) *
$str
àà* I
)
ààI J
;
ààJ K
games
ââ 
[
ââ 
$num
ââ 
]
ââ 
.
ââ 
ChangeImagePath
ââ $
(
ââ$ %
$str
ââ% 8
)
ââ8 9
;
ââ9 :
games
ää 
[
ää 
$num
ää 
]
ää 
.
ää "
ChangeCoverImagePath
ää )
(
ää) *
$str
ää* B
)
ääB C
;
ääC D
foreach
åå 
(
åå 
Game
åå 
s
åå 
in
åå 
games
åå $
)
åå$ %
{
çç 
context
éé 
.
éé 
Games
éé 
.
éé 
Add
éé !
(
éé! "
s
éé" #
)
éé# $
;
éé$ %
}
èè 
context
ëë 
.
ëë 
AddRange
ëë 
(
ëë 
new
íí 
GameDeveloper
íí !
{
íí" #
Game
íí$ (
=
íí) *
games
íí+ 0
[
íí0 1
$num
íí1 2
]
íí2 3
,
íí3 4
	Developer
íí5 >
=
íí? @
	companies
ííA J
[
ííJ K
$num
ííK L
]
ííL M
}
ííN O
,
ííO P
new
ìì 
GameDeveloper
ìì !
{
ìì" #
Game
ìì$ (
=
ìì) *
games
ìì+ 0
[
ìì0 1
$num
ìì1 2
]
ìì2 3
,
ìì3 4
	Developer
ìì5 >
=
ìì? @
	companies
ììA J
[
ììJ K
$num
ììK L
]
ììL M
}
ììN O
,
ììO P
new
îî 
GameDeveloper
îî !
{
îî" #
Game
îî$ (
=
îî) *
games
îî+ 0
[
îî0 1
$num
îî1 2
]
îî2 3
,
îî3 4
	Developer
îî5 >
=
îî? @
	companies
îîA J
[
îîJ K
$num
îîK L
]
îîL M
}
îîN O
,
îîO P
new
ïï 
GameDeveloper
ïï !
{
ïï" #
Game
ïï$ (
=
ïï) *
games
ïï+ 0
[
ïï0 1
$num
ïï1 2
]
ïï2 3
,
ïï3 4
	Developer
ïï5 >
=
ïï? @
	companies
ïïA J
[
ïïJ K
$num
ïïK L
]
ïïL M
}
ïïN O
,
ïïO P
new
ññ 
	GameGenre
ññ 
{
ññ 
Game
ññ  $
=
ññ% &
games
ññ' ,
[
ññ, -
$num
ññ- .
]
ññ. /
,
ññ/ 0
Genre
ññ1 6
=
ññ7 8
genres
ññ9 ?
[
ññ? @
$num
ññ@ A
]
ññA B
}
ññC D
,
ññD E
new
óó 
	GameGenre
óó 
{
óó 
Game
óó  $
=
óó% &
games
óó' ,
[
óó, -
$num
óó- .
]
óó. /
,
óó/ 0
Genre
óó1 6
=
óó7 8
genres
óó9 ?
[
óó? @
$num
óó@ A
]
óóA B
}
óóC D
,
óóD E
new
òò 
	GameGenre
òò 
{
òò 
Game
òò  $
=
òò% &
games
òò' ,
[
òò, -
$num
òò- .
]
òò. /
,
òò/ 0
Genre
òò1 6
=
òò7 8
genres
òò9 ?
[
òò? @
$num
òò@ A
]
òòA B
}
òòC D
,
òòD E
new
ôô 
	GameGenre
ôô 
{
ôô 
Game
ôô  $
=
ôô% &
games
ôô' ,
[
ôô, -
$num
ôô- .
]
ôô. /
,
ôô/ 0
Genre
ôô1 6
=
ôô7 8
genres
ôô9 ?
[
ôô? @
$num
ôô@ A
]
ôôA B
}
ôôC D
,
ôôD E
new
öö 
	GameGenre
öö 
{
öö 
Game
öö  $
=
öö% &
games
öö' ,
[
öö, -
$num
öö- .
]
öö. /
,
öö/ 0
Genre
öö1 6
=
öö7 8
genres
öö9 ?
[
öö? @
$num
öö@ A
]
ööA B
}
ööC D
,
ööD E
new
õõ 
GamePlatform
õõ  
{
õõ! "
Game
õõ# '
=
õõ( )
games
õõ* /
[
õõ/ 0
$num
õõ0 1
]
õõ1 2
,
õõ2 3
Platform
õõ4 <
=
õõ= >
	platforms
õõ? H
[
õõH I
$num
õõI J
]
õõJ K
}
õõL M
,
õõM N
new
úú 
GamePlatform
úú  
{
úú! "
Game
úú# '
=
úú( )
games
úú* /
[
úú/ 0
$num
úú0 1
]
úú1 2
,
úú2 3
Platform
úú4 <
=
úú= >
	platforms
úú? H
[
úúH I
$num
úúI J
]
úúJ K
}
úúL M
,
úúM N
new
ùù 
GamePlatform
ùù  
{
ùù! "
Game
ùù# '
=
ùù( )
games
ùù* /
[
ùù/ 0
$num
ùù0 1
]
ùù1 2
,
ùù2 3
Platform
ùù4 <
=
ùù= >
	platforms
ùù? H
[
ùùH I
$num
ùùI J
]
ùùJ K
}
ùùL M
,
ùùM N
new
ûû 
GamePlatform
ûû  
{
ûû! "
Game
ûû# '
=
ûû( )
games
ûû* /
[
ûû/ 0
$num
ûû0 1
]
ûû1 2
,
ûû2 3
Platform
ûû4 <
=
ûû= >
	platforms
ûû? H
[
ûûH I
$num
ûûI J
]
ûûJ K
}
ûûL M
,
ûûM N
new
üü 
GamePlatform
üü  
{
üü! "
Game
üü# '
=
üü( )
games
üü* /
[
üü/ 0
$num
üü0 1
]
üü1 2
,
üü2 3
Platform
üü4 <
=
üü= >
	platforms
üü? H
[
üüH I
$num
üüI J
]
üüJ K
}
üüL M
,
üüM N
new
†† 
GamePublisher
†† !
{
††" #
Game
††$ (
=
††) *
games
††+ 0
[
††0 1
$num
††1 2
]
††2 3
,
††3 4
	Publisher
††5 >
=
††? @
	companies
††A J
[
††J K
$num
††K L
]
††L M
}
††N O
,
††O P
new
°° 
GamePublisher
°° !
{
°°" #
Game
°°$ (
=
°°) *
games
°°+ 0
[
°°0 1
$num
°°1 2
]
°°2 3
,
°°3 4
	Publisher
°°5 >
=
°°? @
	companies
°°A J
[
°°J K
$num
°°K L
]
°°L M
}
°°N O
,
°°O P
new
¢¢ 
GamePublisher
¢¢ !
{
¢¢" #
Game
¢¢$ (
=
¢¢) *
games
¢¢+ 0
[
¢¢0 1
$num
¢¢1 2
]
¢¢2 3
,
¢¢3 4
	Publisher
¢¢5 >
=
¢¢? @
	companies
¢¢A J
[
¢¢J K
$num
¢¢K L
]
¢¢L M
}
¢¢N O
,
¢¢O P
new
££ 
GamePublisher
££ !
{
££" #
Game
££$ (
=
££) *
games
££+ 0
[
££0 1
$num
££1 2
]
££2 3
,
££3 4
	Publisher
££5 >
=
££? @
	companies
££A J
[
££J K
$num
££K L
]
££L M
}
££N O
)
££O P
;
££P Q
var
•• 
userId1
•• 
=
•• 
await
•• 
_userManager
••  ,
.
••, -
FindByNameAsync
••- <
(
••< =
$str
••= C
)
••C D
;
••D E
var
¶¶ 
userId2
¶¶ 
=
¶¶ 
await
¶¶ 
_userManager
¶¶  ,
.
¶¶, -
FindByNameAsync
¶¶- <
(
¶¶< =
$str
¶¶= L
)
¶¶L M
;
¶¶M N
var
®® 
shoppingCarts
®® 
=
®® 
new
®®  #
ShoppingCart
®®$ 0
[
®®0 1
]
®®1 2
{
®®3 4
new
©© 
ShoppingCart
©©  
(
©©  !
new
©©! $
Guid
©©% )
(
©©) *
userId1
©©* 1
.
©©1 2
Id
©©2 4
)
©©4 5
)
©©5 6
,
©©6 7
new
™™ 
ShoppingCart
™™  
(
™™  !
new
™™! $
Guid
™™% )
(
™™) *
userId2
™™* 1
.
™™1 2
Id
™™2 4
)
™™4 5
)
™™5 6
}
´´ 
;
´´ 
shoppingCarts
≠≠ 
[
≠≠ 
$num
≠≠ 
]
≠≠ 
.
≠≠ 
AddItem
≠≠ $
(
≠≠$ %
new
≠≠% (
CartItem
≠≠) 1
(
≠≠1 2
games
≠≠2 7
[
≠≠7 8
$num
≠≠8 9
]
≠≠9 :
,
≠≠: ;
$num
≠≠< =
)
≠≠= >
)
≠≠> ?
;
≠≠? @
shoppingCarts
ÆÆ 
[
ÆÆ 
$num
ÆÆ 
]
ÆÆ 
.
ÆÆ 
AddItem
ÆÆ $
(
ÆÆ$ %
new
ÆÆ% (
CartItem
ÆÆ) 1
(
ÆÆ1 2
games
ÆÆ2 7
[
ÆÆ7 8
$num
ÆÆ8 9
]
ÆÆ9 :
,
ÆÆ: ;
$num
ÆÆ< =
)
ÆÆ= >
)
ÆÆ> ?
;
ÆÆ? @
shoppingCarts
ØØ 
[
ØØ 
$num
ØØ 
]
ØØ 
.
ØØ 
AddItem
ØØ $
(
ØØ$ %
new
ØØ% (
CartItem
ØØ) 1
(
ØØ1 2
games
ØØ2 7
[
ØØ7 8
$num
ØØ8 9
]
ØØ9 :
,
ØØ: ;
$num
ØØ< =
)
ØØ= >
)
ØØ> ?
;
ØØ? @
shoppingCarts
±± 
[
±± 
$num
±± 
]
±± 
.
±± 
AddItem
±± $
(
±±$ %
new
±±% (
CartItem
±±) 1
(
±±1 2
games
±±2 7
[
±±7 8
$num
±±8 9
]
±±9 :
,
±±: ;
$num
±±< =
)
±±= >
)
±±> ?
;
±±? @
shoppingCarts
≤≤ 
[
≤≤ 
$num
≤≤ 
]
≤≤ 
.
≤≤ 
AddItem
≤≤ $
(
≤≤$ %
new
≤≤% (
CartItem
≤≤) 1
(
≤≤1 2
games
≤≤2 7
[
≤≤7 8
$num
≤≤8 9
]
≤≤9 :
,
≤≤: ;
$num
≤≤< =
)
≤≤= >
)
≤≤> ?
;
≤≤? @
shoppingCarts
≥≥ 
[
≥≥ 
$num
≥≥ 
]
≥≥ 
.
≥≥ 
AddItem
≥≥ $
(
≥≥$ %
new
≥≥% (
CartItem
≥≥) 1
(
≥≥1 2
games
≥≥2 7
[
≥≥7 8
$num
≥≥8 9
]
≥≥9 :
,
≥≥: ;
$num
≥≥< =
)
≥≥= >
)
≥≥> ?
;
≥≥? @
foreach
µµ 
(
µµ 
ShoppingCart
µµ !
c
µµ" #
in
µµ$ &
shoppingCarts
µµ' 4
)
µµ4 5
{
∂∂ 
context
∑∑ 
.
∑∑ 
ShoppingCarts
∑∑ %
.
∑∑% &
Add
∑∑& )
(
∑∑) *
c
∑∑* +
)
∑∑+ ,
;
∑∑, -
}
∏∏ 
var
∫∫ 
paymentMethod1
∫∫ 
=
∫∫  
new
∫∫! $
PayPalPayment
∫∫% 2
(
∫∫2 3
$str
∫∫3 8
,
∫∫8 9
DateTime
∫∫: B
.
∫∫B C
Now
∫∫C F
,
∫∫F G
DateTime
∫∫H P
.
∫∫P Q
Now
∫∫Q T
.
∫∫T U
AddDays
∫∫U \
(
∫∫\ ]
$num
∫∫] ^
)
∫∫^ _
,
∫∫_ `
$num
∫∫` d
,
∫∫d e
$num
∫∫e i
,
∫∫i j
$str
∫∫j p
,
∫∫p q
new
∫∫r u
Email
∫∫v {
(
∫∫{ |
userId1∫∫| É
.∫∫É Ñ
Email∫∫Ñ â
)∫∫â ä
)∫∫ä ã
;∫∫ã å
var
ªª 
paymentMethod2
ªª 
=
ªª  
new
ªª! $
PayPalPayment
ªª% 2
(
ªª2 3
$str
ªª3 8
,
ªª8 9
DateTime
ªª: B
.
ªªB C
Now
ªªC F
,
ªªF G
DateTime
ªªH P
.
ªªP Q
Now
ªªQ T
.
ªªT U
AddDays
ªªU \
(
ªª\ ]
$num
ªª] ^
)
ªª^ _
,
ªª_ `
$num
ªª` d
,
ªªd e
$num
ªªe i
,
ªªi j
$str
ªªj p
,
ªªp q
new
ªªr u
Email
ªªv {
(
ªª{ |
userId2ªª| É
.ªªÉ Ñ
EmailªªÑ â
)ªªâ ä
)ªªä ã
;ªªã å
var
ΩΩ 
order1
ΩΩ 
=
ΩΩ 
new
ΩΩ 
Order
ΩΩ "
(
ΩΩ" #
new
ΩΩ# &
Guid
ΩΩ' +
(
ΩΩ+ ,
userId1
ΩΩ, 3
.
ΩΩ3 4
Id
ΩΩ4 6
)
ΩΩ6 7
,
ΩΩ7 8
shoppingCarts
ΩΩ9 F
[
ΩΩF G
$num
ΩΩG H
]
ΩΩH I
,
ΩΩI J
paymentMethod1
ΩΩK Y
)
ΩΩY Z
;
ΩΩZ [
var
ææ 
order2
ææ 
=
ææ 
new
ææ 
Order
ææ "
(
ææ" #
new
ææ# &
Guid
ææ' +
(
ææ+ ,
userId2
ææ, 3
.
ææ3 4
Id
ææ4 6
)
ææ6 7
,
ææ7 8
shoppingCarts
ææ9 F
[
ææF G
$num
ææG H
]
ææH I
,
ææI J
paymentMethod2
ææK Y
)
ææY Z
;
ææZ [
order1
¿¿ 
.
¿¿ 

Deactivate
¿¿ 
(
¿¿ 
)
¿¿ 
;
¿¿  
order2
¡¡ 
.
¡¡ 

Deactivate
¡¡ 
(
¡¡ 
)
¡¡ 
;
¡¡  
context
√√ 
.
√√ 
Orders
√√ 
.
√√ 
Add
√√ 
(
√√ 
order1
√√ %
)
√√% &
;
√√& '
context
ƒƒ 
.
ƒƒ 
Orders
ƒƒ 
.
ƒƒ 
Add
ƒƒ 
(
ƒƒ 
order2
ƒƒ %
)
ƒƒ% &
;
ƒƒ& '
var
∆∆ 
reviews
∆∆ 
=
∆∆ 
new
∆∆ 
Review
∆∆ $
[
∆∆$ %
]
∆∆% &
{
∆∆' (
new
«« 
Review
«« 
(
«« 
new
«« 
Guid
«« #
(
««# $
userId1
««$ +
.
««+ ,
Id
««, .
)
««. /
,
««/ 0
games
««1 6
[
««6 7
$num
««7 8
]
««8 9
.
««9 :
Id
««: <
,
««< =
$num
««= >
,
««> ?
$str
««@ X
)
««X Y
,
««Y Z
new
»» 
Review
»» 
(
»» 
new
»» 
Guid
»» #
(
»»# $
userId1
»»$ +
.
»»+ ,
Id
»», .
)
»». /
,
»»/ 0
games
»»1 6
[
»»6 7
$num
»»7 8
]
»»8 9
.
»»9 :
Id
»»: <
,
»»< =
$num
»»= >
,
»»> ?
$str
»»@ V
)
»»V W
,
»»W X
new
…… 
Review
…… 
(
…… 
new
…… 
Guid
…… #
(
……# $
userId1
……$ +
.
……+ ,
Id
……, .
)
……. /
,
……/ 0
games
……1 6
[
……6 7
$num
……7 8
]
……8 9
.
……9 :
Id
……: <
,
……< =
$num
……> ?
,
……@ A
$str
……B W
)
……W X
,
……X Y
new
   
Review
   
(
   
new
   
Guid
   #
(
  # $
userId1
  $ +
.
  + ,
Id
  , .
)
  . /
,
  / 0
games
  1 6
[
  6 7
$num
  7 8
]
  8 9
.
  9 :
Id
  : <
,
  < =
$num
  = >
,
  > ?
$str
  @ N
)
  N O
,
  O P
new
ÀÀ 
Review
ÀÀ 
(
ÀÀ 
new
ÀÀ 
Guid
ÀÀ #
(
ÀÀ# $
userId2
ÀÀ$ +
.
ÀÀ+ ,
Id
ÀÀ, .
)
ÀÀ. /
,
ÀÀ/ 0
games
ÀÀ1 6
[
ÀÀ6 7
$num
ÀÀ7 8
]
ÀÀ8 9
.
ÀÀ9 :
Id
ÀÀ: <
,
ÀÀ< =
$num
ÀÀ= >
,
ÀÀ> ?
$str
ÀÀ@ X
)
ÀÀX Y
,
ÀÀY Z
new
ÃÃ 
Review
ÃÃ 
(
ÃÃ 
new
ÃÃ 
Guid
ÃÃ #
(
ÃÃ# $
userId2
ÃÃ$ +
.
ÃÃ+ ,
Id
ÃÃ, .
)
ÃÃ. /
,
ÃÃ/ 0
games
ÃÃ1 6
[
ÃÃ6 7
$num
ÃÃ7 8
]
ÃÃ8 9
.
ÃÃ9 :
Id
ÃÃ: <
,
ÃÃ< =
$num
ÃÃ= >
,
ÃÃ> ?
$str
ÃÃ@ a
)
ÃÃa b
,
ÃÃb c
new
ÕÕ 
Review
ÕÕ 
(
ÕÕ 
new
ÕÕ 
Guid
ÕÕ #
(
ÕÕ# $
userId2
ÕÕ$ +
.
ÕÕ+ ,
Id
ÕÕ, .
)
ÕÕ. /
,
ÕÕ/ 0
games
ÕÕ1 6
[
ÕÕ6 7
$num
ÕÕ7 8
]
ÕÕ8 9
.
ÕÕ9 :
Id
ÕÕ: <
,
ÕÕ< =
$num
ÕÕ= >
,
ÕÕ> ?
$str
ÕÕ@ V
)
ÕÕV W
,
ÕÕW X
new
ŒŒ 
Review
ŒŒ 
(
ŒŒ 
new
ŒŒ 
Guid
ŒŒ #
(
ŒŒ# $
user2
ŒŒ$ )
.
ŒŒ) *
Id
ŒŒ* ,
)
ŒŒ, -
,
ŒŒ- .
games
ŒŒ/ 4
[
ŒŒ4 5
$num
ŒŒ5 6
]
ŒŒ6 7
.
ŒŒ7 8
Id
ŒŒ8 :
,
ŒŒ: ;
$num
ŒŒ; <
,
ŒŒ< =
$str
ŒŒ> N
)
ŒŒN O
,
ŒŒO P
new
œœ 
Review
œœ 
(
œœ 
new
œœ 
Guid
œœ #
(
œœ# $
user2
œœ$ )
.
œœ) *
Id
œœ* ,
)
œœ, -
,
œœ- .
games
œœ/ 4
[
œœ4 5
$num
œœ5 6
]
œœ6 7
.
œœ7 8
Id
œœ8 :
,
œœ: ;
$num
œœ; <
,
œœ< =
$str
œœ> Z
)
œœZ [
,
œœ[ \
new
–– 
Review
–– 
(
–– 
new
–– 
Guid
–– #
(
––# $
user2
––$ )
.
––) *
Id
––* ,
)
––, -
,
––- .
games
––/ 4
[
––4 5
$num
––5 6
]
––6 7
.
––7 8
Id
––8 :
,
––: ;
$num
––; <
,
––< =
$str
––> U
)
––U V
,
––V W
new
—— 
Review
—— 
(
—— 
new
—— 
Guid
—— #
(
——# $
user2
——$ )
.
——) *
Id
——* ,
)
——, -
,
——- .
games
——/ 4
[
——4 5
$num
——5 6
]
——6 7
.
——7 8
Id
——8 :
,
——: ;
$num
——; <
,
——< =
$str
——> H
)
——H I
}
““ 
;
““ 
context
‘‘ 
.
‘‘ 
Reviews
‘‘ 
.
‘‘ 
AddRange
‘‘ $
(
‘‘$ %
reviews
‘‘% ,
)
‘‘, -
;
‘‘- .
context
÷÷ 
.
÷÷ 
SaveChanges
÷÷ 
(
÷÷  
)
÷÷  !
;
÷÷! "
}
◊◊ 	
}
ÿÿ 
}ŸŸ ≤u
ZC:\projects\repos\GameStore\src\4 - Infra\GameStore.Infra.Data\Context\GameStoreContext.cs
	namespace 	
	GameStore
 
. 
Infra 
. 
Data 
. 
Context &
{ 
public 

class 
GameStoreContext !
:" #
IdentityDbContext$ 5
{ 
public 
GameStoreContext 
(  
DbContextOptions  0
<0 1
GameStoreContext1 A
>A B
optionsC J
)J K
: 	
base
 
( 
options 
) 
{ 
} 
public 
DbSet 
< 
Company 
> 
	Companies '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
DbSet 
< 
Game 
> 
Games  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 
Genre 
> 
Genres "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DbSet 
< 
Platform 
> 
	Platforms (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
DbSet 
< 
Order 
> 
Orders "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DbSet 
< 
ShoppingCart !
>! "
ShoppingCarts# 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 
DbSet 
< 
CartItem 
> 
	CartItems (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
DbSet 
< 
CreditCardPayment &
>& '
CreditCardPayments( :
{; <
get= @
;@ A
setB E
;E F
}G H
public 
DbSet 
< 
PayPalPayment "
>" #
PayPalPayments$ 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
public 
DbSet 
< 
Review 
> 
Reviews $
{% &
get' *
;* +
set, /
;/ 0
}1 2
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
modelBuilder   
.   
Entity   
<    
GameDeveloper    -
>  - .
(  . /
)  / 0
.  0 1
HasKey  1 7
(  7 8
t  8 9
=>  : <
new  = @
{  A B
t  C D
.  D E
GameId  E K
,  K L
t  M N
.  N O
DeveloperId  O Z
}  [ \
)  \ ]
;  ] ^
modelBuilder"" 
."" 
Entity"" 
<""  
Payment""  '
>""' (
(""( )
)"") *
.""* +
OwnsOne""+ 2
(""2 3
typeof""3 9
(""9 :
Email"": ?
)""? @
,""@ A
$str""B I
)""I J
;""J K
modelBuilder## 
.## 
Entity## 
<##  
Company##  '
>##' (
(##( )
)##) *
.##* +
OwnsOne##+ 2
(##2 3
typeof##3 9
(##9 :
CompanyName##: E
)##E F
,##F G
$str##H N
)##N O
;##O P
modelBuilder%% 
.%% 
Entity%% 
<%%  
GameDeveloper%%  -
>%%- .
(%%. /
)%%/ 0
.&& 
HasOne&& 
(&& 
gg&& 
=>&& 
gg&& 
.&& 
Game&& !
)&&! "
.'' 
WithMany'' 
('' 
$str'' &
)''& '
;''' (
modelBuilder)) 
.)) 
Entity)) 
<))  
GameDeveloper))  -
>))- .
()). /
)))/ 0
.** 
HasOne** 
(** 
gg** 
=>** 
gg**  
.**  !
	Developer**! *
)*** +
.++ 
WithMany++ 
(++ 
$str++ *
)++* +
;+++ ,
modelBuilder-- 
.-- 
Entity-- 
<--  
	GameGenre--  )
>--) *
(--* +
)--+ ,
.--, -
HasKey--- 3
(--3 4
t--4 5
=>--6 8
new--9 <
{--= >
t--? @
.--@ A
GameId--A G
,--G H
t--I J
.--J K
GenreId--K R
}--S T
)--T U
;--U V
modelBuilder// 
.// 
Entity// 
<//  
	GameGenre//  )
>//) *
(//* +
)//+ ,
.00 
HasOne00 
(00 
gg00 
=>00 
gg00 
.00 
Game00 !
)00! "
.11 
WithMany11 
(11 
$str11 "
)11" #
;11# $
modelBuilder33 
.33 
Entity33 
<33  
	GameGenre33  )
>33) *
(33* +
)33+ ,
.44 
HasOne44 
(44 
gg44 
=>44 
gg44  
.44  !
Genre44! &
)44& '
.55 
WithMany55 
(55 
$str55 &
)55& '
;55' (
modelBuilder77 
.77 
Entity77 
<77  
GamePlatform77  ,
>77, -
(77- .
)77. /
.77/ 0
HasKey770 6
(776 7
t777 8
=>779 ;
new77< ?
{77@ A
t77B C
.77C D
GameId77D J
,77J K
t77L M
.77M N

PlatformId77N X
}77Y Z
)77Z [
;77[ \
modelBuilder99 
.99 
Entity99 
<99  
GamePlatform99  ,
>99, -
(99- .
)99. /
.:: 
HasOne:: 
(:: 
gp:: 
=>:: 
gp:: 
.:: 
Game:: !
)::! "
.;; 
WithMany;; 
(;; 
$str;; %
);;% &
;;;& '
modelBuilder== 
.== 
Entity== 
<==  
GamePlatform==  ,
>==, -
(==- .
)==. /
.>> 
HasOne>> 
(>> 
gp>> 
=>>> 
gp>>  
.>>  !
Platform>>! )
)>>) *
.?? 
WithMany?? 
(?? 
$str?? )
)??) *
;??* +
modelBuilderAA 
.AA 
EntityAA 
<AA  
GamePublisherAA  -
>AA- .
(AA. /
)AA/ 0
.AA0 1
HasKeyAA1 7
(AA7 8
tAA8 9
=>AA: <
newAA= @
{AAA B
tAAC D
.AAD E
GameIdAAE K
,AAK L
tAAM N
.AAN O
PublisherIdAAO Z
}AA[ \
)AA\ ]
;AA] ^
modelBuilderCC 
.CC 
EntityCC 
<CC  
GamePublisherCC  -
>CC- .
(CC. /
)CC/ 0
.DD 
HasOneDD 
(DD 
ggDD 
=>DD 
ggDD 
.DD 
GameDD !
)DD! "
.EE 
WithManyEE 
(EE 
$strEE &
)EE& '
;EE' (
modelBuilderGG 
.GG 
EntityGG 
<GG  
GamePublisherGG  -
>GG- .
(GG. /
)GG/ 0
.HH 
HasOneHH 
(HH 
ggHH 
=>HH 
ggHH  
.HH  !
	PublisherHH! *
)HH* +
.II 
WithManyII 
(II 
$strII *
)II* +
;II+ ,
modelBuilderLL 
.LL 
EntityLL 
<LL  
ShoppingCartLL  ,
>LL, -
(LL- .
)LL. /
.MM 
HasOneMM 
(MM 
sMM 
=>MM 
sMM 
.MM 
OrderMM  
)MM  !
.NN 
WithManyNN 
(NN 
)NN 
.OO 
HasForeignKeyOO 
(OO 
eOO 
=>OO 
eOO  !
.OO! "
OrderIdOO" )
)OO) *
;OO* +
modelBuilderQQ 
.QQ 
EntityQQ 
<QQ  
ShoppingCartQQ  ,
>QQ, -
(QQ- .
)QQ. /
.RR 
HasManyRR 
(RR 
xRR 
=>RR 
xRR 
.RR 
ListOfItemsRR '
)RR' (
.SS 
WithOneSS 
(SS 
_SS 
=>SS 
_SS 
.SS 
ShoppingCartSS (
)SS( )
.TT 
HasForeignKeyTT 
(TT 
fTT 
=>TT 
fTT  !
.TT! "
ShoppingCartIdTT" 0
)TT0 1
;TT1 2
modelBuilderVV 
.VV 
EntityVV 
<VV  
CartItemVV  (
>VV( )
(VV) *
)VV* +
.WW 
HasOneWW 
(WW 
_WW 
=>WW 
_WW 
.WW 
ShoppingCartWW '
)WW' (
.XX 
WithManyXX 
(XX 
xXX 
=>XX 
xXX 
.XX 
ListOfItemsXX (
)XX( )
.YY 
HasForeignKeyYY 
(YY 
fYY 
=>YY 
fYY  !
.YY! "
ShoppingCartIdYY" 0
)YY0 1
;YY1 2
modelBuilder[[ 
.[[ 
Entity[[ 
<[[  
CartItem[[  (
>[[( )
([[) *
)[[* +
.\\ 
HasOne\\ 
(\\ 
_\\ 
=>\\ 
_\\ 
.\\ 
Product\\ "
)\\" #
.]] 
WithMany]] 
(]] 
)]] 
.^^ 
HasForeignKey^^ 
(^^ 
f^^ 
=>^^ 
f^^  !
.^^! "
	ProductId^^" +
)^^+ ,
;^^, -
base`` 
.`` 
OnModelCreating``  
(``  !
modelBuilder``! -
)``- .
;``. /
modelBuilderbb 
.bb 
Entitybb 
<bb  
Reviewbb  &
>bb& '
(bb' (
)bb( )
.cc 
HasOnecc 
(cc 
_cc 
=>cc 
_cc 
.cc 
Productcc !
)cc! "
.dd 
WithManydd 
(dd 
_dd 
=>dd 
_dd 
.dd 
Reviewsdd $
)dd$ %
.ee 
HasForeignKeyee 
(ee 
_ee 
=>ee 
_ee  !
.ee! "
	ProductIdee" +
)ee+ ,
;ee, -
}gg 	
publicii 
overrideii 
intii 
SaveChangesii '
(ii' (
)ii( )
{jj 	
foreachll 
(ll 
varll 
entryll 
inll !
ChangeTrackerll" /
.ll/ 0
Entriesll0 7
(ll7 8
)ll8 9
.ll9 :
Wherell: ?
(ll? @
entryll@ E
=>llF H
entryllI N
.llN O
EntityllO U
.llU V
GetTypellV ]
(ll] ^
)ll^ _
.ll_ `
GetPropertyll` k
(llk l
$strlll y
)lly z
!=ll{ }
null	ll~ Ç
)
llÇ É
)
llÉ Ñ
{mm 
ifnn 
(nn 
entrynn 
.nn 
Statenn 
==nn  "
EntityStatenn# .
.nn. /
Addednn/ 4
)nn4 5
{oo 
entrypp 
.pp 
Propertypp "
(pp" #
$strpp# 0
)pp0 1
.pp1 2
CurrentValuepp2 >
=pp? @
DateTimeppA I
.ppI J
NowppJ M
;ppM N
}qq 
ifrr 
(rr 
entryrr 
.rr 
Staterr 
==rr  "
EntityStaterr# .
.rr. /
Modifiedrr/ 7
)rr7 8
{ss 
entrytt 
.tt 
Propertytt "
(tt" #
$strtt# 0
)tt0 1
.tt1 2

IsModifiedtt2 <
=tt= >
falsett? D
;ttD E
}uu 
}vv 
foreachww 
(ww 
varww 
entryww 
inww !
ChangeTrackerww" /
.ww/ 0
Entriesww0 7
(ww7 8
)ww8 9
.ww9 :
Whereww: ?
(ww? @
entryww@ E
=>wwF H
entrywwI N
.wwN O
EntitywwO U
.wwU V
GetTypewwV ]
(ww] ^
)ww^ _
.ww_ `
GetPropertyww` k
(wwk l
$strwwl y
)wwy z
!=ww{ }
null	ww~ Ç
)
wwÇ É
)
wwÉ Ñ
{xx 
entryyy 
.yy 
Propertyyy 
(yy 
$stryy ,
)yy, -
.yy- .
CurrentValueyy. :
=yy; <
DateTimeyy= E
.yyE F
NowyyF I
;yyI J
}zz 
foreach{{ 
({{ 
var{{ 
entry{{ 
in{{ !
ChangeTracker{{" /
.{{/ 0
Entries{{0 7
({{7 8
){{8 9
.{{9 :
Where{{: ?
({{? @
entry{{@ E
=>{{F H
entry{{I N
.{{N O
Entity{{O U
.{{U V
GetType{{V ]
({{] ^
){{^ _
.{{_ `
GetProperty{{` k
({{k l
$str{{l t
){{t u
!={{v x
null{{y }
){{} ~
){{~ 
{|| 
if}} 
(}} 
entry}} 
.}} 
State}} 
==}}  "
EntityState}}# .
.}}. /
Added}}/ 4
)}}4 5
{~~ 
entry 
. 
Property "
(" #
$str# +
)+ ,
., -
CurrentValue- 9
=: ;
true< @
;@ A
}
ÄÄ 
}
ÅÅ 
return
ÇÇ 
base
ÇÇ 
.
ÇÇ 
SaveChanges
ÇÇ #
(
ÇÇ# $
)
ÇÇ$ %
;
ÇÇ% &
}
ÉÉ 	
}
ÑÑ 
}ÖÖ «,
`C:\projects\repos\GameStore\src\4 - Infra\GameStore.Infra.Data\Repositories\Common\Repository.cs
	namespace 	
	GameStore
 
. 
Infra 
. 
Data 
. 
Repositories +
.+ ,
Common, 2
{ 
public 

abstract 
class 

Repository $
<$ %
TEntity% ,
>, -
:. /
IRepository0 ;
<; <
TEntity< C
>C D
,D E
IDisposableF Q
whereR W
TEntityX _
:` a

BaseEntityb l
{ 
private 
GameStoreContext  
_db! $
;$ %
public 

Repository 
( 
GameStoreContext *
db+ -
)- .
{ 	
_db 
= 
db 
; 
} 	
public 
virtual 
Guid 
Add 
(  
TEntity  '
obj( +
)+ ,
{ 	
_db 
. 
Set 
< 
TEntity 
> 
( 
) 
. 
Add "
(" #
obj# &
)& '
;' (
_db 
. 
SaveChanges 
( 
) 
; 
return 
obj 
. 
Id 
; 
} 	
public 
async 
virtual 
Task !
<! "
IEnumerable" -
<- .
TEntity. 5
>5 6
>6 7
GetAllAsync8 C
(C D
)D E
{ 	
return   
await   
_db   
.   
Set    
<    !
TEntity  ! (
>  ( )
(  ) *
)  * +
.  + ,
ToListAsync  , 7
(  7 8
)  8 9
;  9 :
}!! 	
public## 
async## 
virtual## 
Task## !
<##! "
TEntity##" )
>##) *
GetByIdAsync##+ 7
(##7 8
Guid##8 <
id##= ?
)##? @
{$$ 	
return%% 
await%% 
_db%% 
.%% 
Set%%  
<%%  !
TEntity%%! (
>%%( )
(%%) *
)%%* +
.%%+ ,
Where%%, 1
(%%1 2
x%%2 3
=>%%4 6
x%%7 8
.%%8 9
Id%%9 ;
==%%< >
id%%? A
)%%A B
.%%B C
FirstOrDefaultAsync%%C V
(%%V W
)%%W X
;%%X Y
}&& 	
public'' 
virtual'' 
void'' 
Remove'' "
(''" #
Guid''# '
id''( *
)''* +
{(( 	
var)) 
entity)) 
=)) 
GetById))  
())  !
id))! #
)))# $
;))$ %
_db** 
.** 
Set** 
<** 
TEntity** 
>** 
(** 
)** 
.** 
Remove** %
(**% &
entity**& ,
)**, -
;**- .
_db++ 
.++ 
SaveChanges++ 
(++ 
)++ 
;++ 
},, 	
public.. 
virtual.. 
IEnumerable.. "
<.." #
TEntity..# *
>..* +
GetAll.., 2
(..2 3
)..3 4
{// 	
return00 
_db00 
.00 
Set00 
<00 
TEntity00 "
>00" #
(00# $
)00$ %
.00% &
ToList00& ,
(00, -
)00- .
;00. /
}11 	
public33 
TEntity33 
GetById33 
(33 
Guid33 #
id33$ &
)33& '
{44 	
return55 
_db55 
.55 
Set55 
<55 
TEntity55 "
>55" #
(55# $
)55$ %
.55% &
Where55& +
(55+ ,
p55, -
=>55. 0
p551 2
.552 3
Id553 5
==556 8
id559 ;
)55; <
.55< =
FirstOrDefault55= K
(55K L
)55L M
;55M N
}66 	
public88 
virtual88 
void88 
Update88 "
(88" #
TEntity88# *
obj88+ .
)88. /
{99 	
_db:: 
.:: 
Entry:: 
(:: 
obj:: 
):: 
.:: 
State::  
=::! "
EntityState::# .
.::. /
Modified::/ 7
;::7 8
_db;; 
.;; 
SaveChanges;; 
(;; 
);; 
;;; 
}<< 	
private?? 
bool?? 
disposedValue?? "
=??# $
false??% *
;??* +
	protectedAA 
virtualAA 
voidAA 
DisposeAA &
(AA& '
boolAA' +
	disposingAA, 5
)AA5 6
{BB 	
ifCC 
(CC 
!CC 
disposedValueCC 
)CC 
{DD 
ifEE 
(EE 
	disposingEE 
)EE 
{FF 
}HH 
disposedValueMM 
=MM 
trueMM  $
;MM$ %
}NN 
}OO 	
publicXX 
voidXX 
DisposeXX 
(XX 
)XX 
{YY 	
Dispose[[ 
([[ 
true[[ 
)[[ 
;[[ 
}^^ 	
}aa 
}bb ¥
`C:\projects\repos\GameStore\src\4 - Infra\GameStore.Infra.Data\Repositories\CompanyRepository.cs
	namespace 	
	GameStore
 
. 
Infra 
. 
Data 
. 
Repositories +
{ 
public 

class 
ComapanyRepository #
:$ %

Repository& 0
<0 1
Company1 8
>8 9
,9 :
ICompanyRepository; M
{ 
private 
GameStoreContext  
_db! $
;$ %
public 
ComapanyRepository !
(! "
GameStoreContext" 2
db3 5
)5 6
:7 8
base9 =
(= >
db> @
)@ A
{ 	
_db 
= 
db 
; 
} 	
public 
override 
async 
Task "
<" #
IEnumerable# .
<. /
Company/ 6
>6 7
>7 8
GetAllAsync9 D
(D E
)E F
{ 	
return 
await 
_db 
. 
	Companies &
. 
Include 
( 
_  
=>! #
_$ %
.% &
GameDevelopers& 4
)4 5
. 
ThenInclude "
(" #
_# $
=>% '
_( )
.) *
Game* .
). /
. 
Include 
( 
_  
=>! #
_$ %
.% &
GamePublishers& 4
)4 5
. 
ThenInclude "
(" #
_# $
=>% '
_( )
.) *
Game* .
). /
. 
ToListAsync "
(" #
)# $
;$ %
} 	
public   
override   
async   
Task   "
<  " #
Company  # *
>  * +
GetByIdAsync  , 8
(  8 9
Guid  9 =
id  > @
)  @ A
{!! 	
return"" 
await"" 
_db"" 
."" 
	Companies"" &
.## 
Include## 
(## 
_##  
=>##! #
_##$ %
.##% &
GameDevelopers##& 4
)##4 5
.$$ 
ThenInclude$$ "
($$" #
_$$# $
=>$$% '
_$$( )
.$$) *
Game$$* .
)$$. /
.%% 
Where%% 
(%% 
_%% 
=>%% !
_%%" #
.%%# $
Id%%$ &
==%%' )
id%%* ,
)%%, -
.&& 
FirstOrDefaultAsync&& *
(&&* +
)&&+ ,
;&&, -
}'' 	
}(( 
})) Âm
]C:\projects\repos\GameStore\src\4 - Infra\GameStore.Infra.Data\Repositories\GameRepository.cs
	namespace 	
	GameStore
 
. 
Infra 
. 
Data 
. 
Repositories +
{ 
public 

class 
GameRepository 
:  !

Repository" ,
<, -
Game- 1
>1 2
,2 3
IGameRepository4 C
{ 
private 
GameStoreContext  
_db! $
;$ %
public 
GameRepository 
( 
GameStoreContext .
db/ 1
)1 2
:3 4
base5 9
(9 :
db: <
)< =
{ 	
_db 
= 
db 
; 
} 	
public 
IEnumerable 
< 
Game 
>  
SearchByName! -
(- .
string. 4
search5 ;
); <
{ 	
return 
_db 
. 
Games 
. 
Where "
(" #
p# $
=>% '
p( )
.) *
Name* .
.. /
Contains/ 7
(7 8
search8 >
)> ?
)? @
;@ A
} 	
public 
async 
Task 
< 
IEnumerable %
<% &
dynamic& -
>- .
>. /*
GetAllGamesWithDevelopersAsync0 N
(N O
)O P
{ 	
var 
query 
= 
from 
game !
in" $
_db% (
.( )
Games) .
select 
new "
{# $
game% )
}* +
;+ ,
return   
await   
query   
.   
ToListAsync   *
(  * +
)  + ,
;  , -
}!! 	
public$$ 
async$$ 
Task$$ 
<$$ 
IEnumerable$$ %
<$$% &
Game$$& *
>$$* +
>$$+ ,)
GetAllGamesFromThisGenreAsync$$- J
($$J K
Guid$$K O
genreId$$P W
)$$W X
{%% 	
return&& 
await&& 
_db&& 
.&& 
Games&& "
.'' 
Include'' 
('' 
_''  
=>''! #
_''$ %
.''% &
GameDevelopers''& 4
)''4 5
.(( 
ThenInclude(( "
(((" #
_((# $
=>((% '
_((( )
.(() *
	Developer((* 3
)((3 4
.)) 
Include)) 
()) 
_))  
=>))! #
_))$ %
.))% &

GameGenres))& 0
)))0 1
.** 
ThenInclude** "
(**" #
_**# $
=>**% '
_**( )
.**) *
Genre*** /
)**/ 0
.++ 
Include++ 
(++ 
_++  
=>++! #
_++$ %
.++% &
GamePlatforms++& 3
)++3 4
.,, 
ThenInclude,, "
(,," #
_,,# $
=>,,% '
_,,( )
.,,) *
Platform,,* 2
),,2 3
.-- 
Include-- 
(-- 
_--  
=>--! #
_--$ %
.--% &
GamePublishers--& 4
)--4 5
... 
ThenInclude.. "
(.." #
_..# $
=>..% '
_..( )
...) *
	Publisher..* 3
)..3 4
.// 
Where// 
(// 
_// 
=>// !
_//" #
.//# $

GameGenres//$ .
.//. /
Any/// 2
(//2 3
x//3 4
=>//5 7
x//8 9
.//9 :
GenreId//: A
==//B D
genreId//E L
)//L M
)//M N
.00 
ToListAsync00 "
(00" #
)00# $
;00$ %
}11 	
public33 
override33 
async33 
Task33 "
<33" #
IEnumerable33# .
<33. /
Game33/ 3
>333 4
>334 5
GetAllAsync336 A
(33A B
)33B C
{44 	
return55 
await55 
_db55 
.55 
Games55 "
.66 
Include66 
(66 
_66  
=>66! #
_66$ %
.66% &
GameDevelopers66& 4
)664 5
.77 
ThenInclude77 "
(77" #
_77# $
=>77% '
_77( )
.77) *
	Developer77* 3
)773 4
.88 
Include88 
(88 
_88  
=>88! #
_88$ %
.88% &

GameGenres88& 0
)880 1
.99 
ThenInclude99 "
(99" #
_99# $
=>99% '
_99( )
.99) *
Genre99* /
)99/ 0
.:: 
Include:: 
(:: 
_::  
=>::! #
_::$ %
.::% &
GamePlatforms::& 3
)::3 4
.;; 
ThenInclude;; "
(;;" #
_;;# $
=>;;% '
_;;( )
.;;) *
Platform;;* 2
);;2 3
.<< 
Include<< 
(<< 
_<<  
=><<! #
_<<$ %
.<<% &
GamePublishers<<& 4
)<<4 5
.== 
ThenInclude== "
(==" #
_==# $
=>==% '
_==( )
.==) *
	Publisher==* 3
)==3 4
.>> 
ToListAsync>> "
(>>" #
)>># $
;>>$ %
}?? 	
publicAA 
overrideAA 
asyncAA 
TaskAA "
<AA" #
GameAA# '
>AA' (
GetByIdAsyncAA) 5
(AA5 6
GuidAA6 :
idAA; =
)AA= >
{BB 	
returnCC 
awaitCC 
_dbCC 
.CC 
GamesCC "
.DD 
IncludeDD 
(DD 
_DD  
=>DD! #
_DD$ %
.DD% &
GameDevelopersDD& 4
)DD4 5
.EE 
ThenIncludeEE "
(EE" #
_EE# $
=>EE% '
_EE( )
.EE) *
	DeveloperEE* 3
)EE3 4
.FF 
IncludeFF 
(FF 
_FF  
=>FF! #
_FF$ %
.FF% &

GameGenresFF& 0
)FF0 1
.GG 
ThenIncludeGG "
(GG" #
_GG# $
=>GG% '
_GG( )
.GG) *
GenreGG* /
)GG/ 0
.HH 
IncludeHH 
(HH 
_HH  
=>HH! #
_HH$ %
.HH% &
GamePlatformsHH& 3
)HH3 4
.II 
ThenIncludeII "
(II" #
_II# $
=>II% '
_II( )
.II) *
PlatformII* 2
)II2 3
.JJ 
IncludeJJ 
(JJ 
_JJ  
=>JJ! #
_JJ$ %
.JJ% &
GamePublishersJJ& 4
)JJ4 5
.KK 
ThenIncludeKK "
(KK" #
_KK# $
=>KK% '
_KK( )
.KK) *
	PublisherKK* 3
)KK3 4
.LL 
IncludeLL 
(LL 
_LL  
=>LL! #
_LL$ %
.LL% &
ReviewsLL& -
)LL- .
.MM 
WhereMM 
(MM 
_MM 
=>MM !
_MM" #
.MM# $
IdMM$ &
==MM' )
idMM* ,
)MM, -
.NN 
FirstOrDefaultAsyncNN *
(NN* +
)NN+ ,
;NN, -
}OO 	
publicQQ 
asyncQQ 
TaskQQ 
<QQ 
IEnumerableQQ %
<QQ% &
GameQQ& *
>QQ* +
>QQ+ ,"
GetBestRatedGamesAsyncQQ- C
(QQC D
)QQD E
{RR 	
varSS 
querySS 
=SS 
(SS 
fromSS 
gamesSS #
inSS$ &
_dbSS' *
.SS* +
GamesSS+ 0
orderbyTT  
gamesTT! &
.TT& '

UsersScoreTT' 1

descendingTT2 <
selectUU 
gamesUU  %
)UU% &
.UU& '
TakeUU' +
(UU+ ,
$numUU, -
)UU- .
;UU. /
returnVV 
awaitVV 
queryVV 
.VV 
ToListAsyncVV *
(VV* +
)VV+ ,
;VV, -
}WW 	
publicYY 
asyncYY 
TaskYY 
<YY 
IEnumerableYY %
<YY% &
GameYY& *
>YY* +
>YY+ ,#
GetBestSellerGamesAsyncYY- D
(YYD E
)YYE F
{ZZ 	
return[[ 
await[[ 
Task[[ 
.[[ 
Run[[ !
([[! "
([[" #
)[[# $
=>[[% '
{\\ 
return]] 
(]] 
from^^ 
	cartItems^^ 
in^^ !
_db^^" %
.^^% &
	CartItems^^& /
join__ 
carts__ 
in__ 
_db__ !
.__! "
ShoppingCarts__" /
on__0 2
	cartItems__3 <
.__< =
ShoppingCartId__= K
equals__L R
carts__S X
.__X Y
Id__Y [
join`` 
orders`` 
in`` 
_db`` "
.``" #
Orders``# )
on``* ,
carts``- 2
.``2 3
Id``3 5
equals``6 <
orders``= C
.``C D
ShoppingCartId``D R
groupaa 
	cartItemsaa 
byaa  "
	cartItemsaa# ,
.aa, -
	ProductIdaa- 6
intoaa7 ;
ctGroupaa< C
letbb 
countbb 
=bb 
ctGroupbb #
.bb# $
Countbb$ )
(bb) *
)bb* +
joincc 
gamescc 
incc 
_dbcc !
.cc! "
Gamescc" '
oncc( *
ctGroupcc+ 2
.cc2 3
Keycc3 6
equalscc7 =
gamescc> C
.ccC D
IdccD F
orderbydd 
countdd 

descendingdd (
selectee 
gamesee 
)ff 
.ff 
Takeff 
(ff 
$numff 
)ff 
;ff 
}gg 
)gg 
;gg 
}hh 	
publicjj 
overridejj 
voidjj 
Updatejj #
(jj# $
Gamejj$ (
objjj) ,
)jj, -
{kk 	
Gamell 
gamell 
=ll 
_dbll 
.ll 
Gamesll !
.ll! "
Includell" )
(ll) *
_ll* +
=>ll, .
_ll/ 0
.ll0 1
GameDevelopersll1 ?
)ll? @
.mm 
ThenIncludemm "
(mm" #
_mm# $
=>mm% '
_mm( )
.mm) *
	Developermm* 3
)mm3 4
.nn 
Includenn 
(nn 
_nn  
=>nn! #
_nn$ %
.nn% &

GameGenresnn& 0
)nn0 1
.oo 
ThenIncludeoo "
(oo" #
_oo# $
=>oo% '
_oo( )
.oo) *
Genreoo* /
)oo/ 0
.pp 
Includepp 
(pp 
_pp  
=>pp! #
_pp$ %
.pp% &
GamePlatformspp& 3
)pp3 4
.qq 
ThenIncludeqq "
(qq" #
_qq# $
=>qq% '
_qq( )
.qq) *
Platformqq* 2
)qq2 3
.rr 
Includerr 
(rr 
_rr  
=>rr! #
_rr$ %
.rr% &
GamePublishersrr& 4
)rr4 5
.ss 
ThenIncludess "
(ss" #
_ss# $
=>ss% '
_ss( )
.ss) *
	Publisherss* 3
)ss3 4
.ss4 5
FirstOrDefaultss5 C
(ssC D
xssD E
=>ssF H
xssI J
.ssJ K
IdssK M
==ssN P
objssQ T
.ssT U
IdssU W
)ssW X
;ssX Y
iftt 
(tt 
gamett 
istt 
nulltt 
)tt 
throwuu 
newuu 
ArgumentExceptionuu +
(uu+ ,
)uu, -
;uu- .
gameyy 
.yy 

ChangeNameyy 
(yy 
objyy 
.yy  
Nameyy  $
)yy$ %
;yy% &
gamezz 
.zz 
ChangePricezz 
(zz 
objzz  
.zz  !
Pricezz! &
)zz& '
;zz' (
game{{ 
.{{ 
ChangeReleaseDate{{ "
({{" #
obj{{# &
.{{& '
ReleaseDate{{' 2
){{2 3
;{{3 4
game|| 
.|| 
ChangeDescription|| "
(||" #
obj||# &
.||& '
Description||' 2
)||2 3
;||3 4
game}} 
.}} "
ChangeShortDescription}} '
(}}' (
obj}}( +
.}}+ ,
ShortDescription}}, <
)}}< =
;}}= >
game~~ 
.~~  
ChangeDevelopersList~~ %
(~~% &
obj~~& )
.~~) *
GameDevelopers~~* 8
)~~8 9
;~~9 :
game 
.  
ChangePublishersList %
(% &
obj& )
.) *
GamePublishers* 8
)8 9
;9 :
game
ÄÄ 
.
ÄÄ 
ChangeGenresList
ÄÄ !
(
ÄÄ! "
obj
ÄÄ" %
.
ÄÄ% &

GameGenres
ÄÄ& 0
)
ÄÄ0 1
;
ÄÄ1 2
game
ÅÅ 
.
ÅÅ !
ChangePlatformsList
ÅÅ $
(
ÅÅ$ %
obj
ÅÅ% (
.
ÅÅ( )
GamePlatforms
ÅÅ) 6
)
ÅÅ6 7
;
ÅÅ7 8
_db
ÇÇ 
.
ÇÇ 
SaveChanges
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
}
ÉÉ 	
}
ÖÖ 
}ÜÜ Ê
^C:\projects\repos\GameStore\src\4 - Infra\GameStore.Infra.Data\Repositories\GenreRepository.cs
	namespace 	
	GameStore
 
. 
Infra 
. 
Data 
. 
Repositories +
{ 
public 

class 
GenreRepository  
:! "

Repository# -
<- .
Genre. 3
>3 4
,4 5
IGenreRepository6 F
{ 
private 
GameStoreContext  
_db! $
;$ %
public 
GenreRepository 
( 
GameStoreContext /
db0 2
)2 3
:4 5
base6 :
(: ;
db; =
)= >
{ 	
_db 
= 
db 
; 
} 	
public 
override 
async 
Task "
<" #
IEnumerable# .
<. /
Genre/ 4
>4 5
>5 6
GetAllAsync7 B
(B C
)C D
{E F
return 
await 
_db 
. 
Genres $
. 
Include $
($ %
x% &
=>' )
x* +
.+ ,

GameGenres, 6
)6 7
. 
ThenInclude (
(( )
x) *
=>+ -
x. /
./ 0
Game0 4
)4 5
. 
ToListAsync (
(( )
)) *
;* +
} 	
public 
override 
async 
Task "
<" #
Genre# (
>( )
GetByIdAsync* 6
(6 7
Guid7 ;
id< >
)> ?
{ 	
return 
await 
_db 
. 
Genres #
. 
Include 
( 
_  
=>! #
_$ %
.% &

GameGenres& 0
)0 1
.   
ThenInclude   "
(  " #
_  # $
=>  % '
_  ( )
.  ) *
Game  * .
)  . /
.!! 
Where!! 
(!! 
_!! 
=>!! !
_!!" #
.!!# $
Id!!$ &
==!!' )
id!!* ,
)!!, -
."" 
FirstOrDefaultAsync"" *
(""* +
)""+ ,
;"", -
}## 	
}$$ 
}%% î
^C:\projects\repos\GameStore\src\4 - Infra\GameStore.Infra.Data\Repositories\OrderRepository.cs
	namespace 	
	GameStore
 
. 
Infra 
. 
Data 
. 
Repositories +
{ 
public 

class 
OrderRepository  
:! "
IOrderRepository# 3
{		 
private

 
GameStoreContext

  
_db

! $
;

$ %
public 
OrderRepository 
( 
GameStoreContext /
db0 2
)2 3
{ 	
_db 
= 
db 
; 
} 	
public 
void 
CreateOrder 
(  
Order  %
order& +
)+ ,
{ 	
_db 
. 
Orders 
. 
Add 
( 
order  
)  !
;! "
_db 
. 
SaveChanges 
( 
) 
; 
} 	
public 
void 
FinishOrder 
(  
Order  %
order& +
)+ ,
{- .
var 
cart 
= 
_db 
. 
ShoppingCarts (
.( )
Where) .
(. /
_/ 0
=>1 3
_4 5
.5 6
Id6 8
==9 ;
order< A
.A B
ShoppingCartB N
.N O
IdO Q
)Q R
.R S
FirstOrDefaultS a
(a b
)b c
;c d
order 
. 

Deactivate 
( 
) 
; 
cart 
. 

Deactivate 
( 
) 
; 
} 	
} 
} ı
aC:\projects\repos\GameStore\src\4 - Infra\GameStore.Infra.Data\Repositories\PlatformRepository.cs
	namespace		 	
	GameStore		
 
.		 
Infra		 
.		 
Data		 
.		 
Repositories		 +
{

 
public 

class 
PlatformRepository #
:$ %

Repository& 0
<0 1
Platform1 9
>9 :
,: ;
IPlatformRepository< O
{ 
private 
GameStoreContext  
_db! $
;$ %
public 
PlatformRepository !
(! "
GameStoreContext" 2
db3 5
)5 6
:7 8
base9 =
(= >
db> @
)@ A
{ 	
_db 
= 
db 
; 
} 	
public 
override 
async 
Task "
<" #
IEnumerable# .
<. /
Platform/ 7
>7 8
>8 9
GetAllAsync: E
(E F
)F G
{H I
return 
await 
_db 
. 
	Platforms '
. 
Include $
($ %
x% &
=>' )
x* +
.+ ,
GamePlatforms, 9
)9 :
. 
ThenInclude (
(( )
x) *
=>+ -
x. /
./ 0
Game0 4
)4 5
. 
ToListAsync (
(( )
)) *
;* +
} 	
} 
} é
_C:\projects\repos\GameStore\src\4 - Infra\GameStore.Infra.Data\Repositories\ReviewRepository.cs
	namespace

 	
	GameStore


 
.

 
Infra

 
.

 
Data

 
.

 
Repositories

 +
{ 
public 

class 
ReviewRepository !
:" #

Repository$ .
<. /
Review/ 5
>5 6
,6 7
IReviewRepository8 I
{ 
private 
GameStoreContext  
_db! $
;$ %
public 
ReviewRepository 
(  
GameStoreContext  0
db1 3
)3 4
:5 6
base7 ;
(; <
db< >
)> ?
{ 	
_db 
= 
db 
; 
} 	
public 
IEnumerable 
< 
Review !
>! " 
GetReviewByProductId# 7
(7 8
Guid8 <
	productId= F
)F G
{ 	
return 
from 
review 
in !
_db" %
.% &
Reviews& -
where 
review 
.  
	ProductId  )
==* ,
	productId- 6
select 
review  
;  !
} 	
public 
IEnumerable 
< 
Review !
>! "
GetReviewByUserId# 4
(4 5
Guid5 9
userId: @
)@ A
{ 	
return 
from 
review 
in !
_db" %
.% &
Reviews& -
where 
review 
.  
UserId  &
==' )
userId* 0
select 
review  
;  !
}   	
}!! 
}"" ¬
eC:\projects\repos\GameStore\src\4 - Infra\GameStore.Infra.Data\Repositories\ShoppingCartRepository.cs
	namespace 	
	GameStore
 
. 
Infra 
. 
Data 
. 
Repositories +
{		 
public

 

class

 "
ShoppingCartRepository

 '
:

( )

Repository

* 4
<

4 5
ShoppingCart

5 A
>

A B
,

B C#
IShoppingCartRepository

D [
{ 
private 
readonly 
GameStoreContext )
_db* -
;- .
public "
ShoppingCartRepository %
(& '
GameStoreContext' 7
db8 :
): ;
:< =
base> B
(B C
dbC E
)E F
{ 	
_db 
= 
db 
; 
} 	
public 
ShoppingCart )
GetActiveShoppingCartByUserId 9
(9 :
Guid: >
userId? E
)E F
{G H
return 
_db 
. 
ShoppingCarts $
.$ %
Where% *
(* +
_+ ,
=>- /
_0 1
.1 2
UserId2 8
==9 ;
userId< B
&&C E
_F G
.G H
ActiveH N
)N O
.O P
FirstOrDefaultP ^
(^ _
)_ `
;` a
} 	
public 
override 
Guid 
Add  
(  !
ShoppingCart! -
cart. 2
)2 3
{4 5
if 
( 
_db 
. 
ShoppingCarts  
.  !
Where! &
(& '
_' (
=>) +
_, -
.- .
Id. 0
==1 3
cart4 8
.8 9
Id9 ;
&&< >
_? @
.@ A
ActiveA G
)G H
.H I
CountI N
(N O
)O P
>Q R
$numS T
)T U
throw 
new 
	Exception #
(# $
$str$ \
)\ ]
;] ^
else 
_db 
. 
Set 
< 
ShoppingCart #
># $
($ %
)% &
.& '
Add' *
(* +
cart+ /
)/ 0
;0 1
_db 
. 
SaveChanges 
( 
) 
; 
return 
cart 
. 
Id 
; 
} 	
} 
}   ñ*
YC:\projects\repos\GameStore\src\4 - Infra\GameStore.Infra.Data\Repositories\UnitOfWork.cs
	namespace 	
	GameStore
 
. 
Infra 
. 
Data 
. 
Repositories +
{ 
public		 

class		 

UnitOfWork		 
:		 
IUnitOfWork		 )
{

 
private 
IGameRepository 
_gameRepository  /
;/ 0
private 
ICompanyRepository "
_companyRepository# 5
;5 6
private 
IGenreRepository  
_genreRepository! 1
;1 2
private 
IPlatformRepository #
_platformRepository$ 7
;7 8
private 
IUserRepository 
_userRepository  /
;/ 0
private 
IOrderRepository  
_orderRepository! 1
;1 2
private 
IReviewRepository !
_reviewRepository" 3
;3 4
private 
readonly 
GameStoreContext )
_db* -
;- .
public 

UnitOfWork 
( 
GameStoreContext *
db+ -
)- .
{/ 0
_db1 4
=5 6
db7 9
;9 :
}; <
public 
IGameRepository 
Games $
{ 	
get 
{ 
if 
( 
_gameRepository #
==$ &
null' +
)+ ,
{ 
_gameRepository #
=$ %
new& )
GameRepository* 8
(8 9
_db9 <
)< =
;= >
} 
return 
_gameRepository &
;& '
} 
}   	
public"" 
ICompanyRepository"" !
	Companies""" +
{## 	
get$$ 
{%% 
if&& 
(&& 
_companyRepository&& &
==&&' )
null&&* .
)&&. /
{'' 
_companyRepository(( &
=((' (
new(() ,
ComapanyRepository((- ?
(((? @
_db((@ C
)((C D
;((D E
})) 
return** 
_companyRepository** )
;**) *
}++ 
},, 	
public.. 
IGenreRepository.. 
Genres..  &
{// 	
get00 
{11 
if22 
(22 
_genreRepository22 $
==22% '
null22( ,
)22, -
{33 
_genreRepository44 $
=44% &
new44' *
GenreRepository44+ :
(44: ;
_db44; >
)44> ?
;44? @
}55 
return66 
_genreRepository66 '
;66' (
}77 
}88 	
public:: 
IPlatformRepository:: "
	Platforms::# ,
{;; 	
get<< 
{== 
if>> 
(>> 
_platformRepository>> '
==>>( *
null>>+ /
)>>/ 0
{?? 
_platformRepository@@ '
=@@( )
new@@* -
PlatformRepository@@. @
(@@@ A
_db@@A D
)@@D E
;@@E F
}AA 
returnBB 
_platformRepositoryBB *
;BB* +
}CC 
}DD 	
publicFF 
IUserRepositoryFF 
UsersFF $
{GG 	
getHH 
{II 
ifJJ 
(JJ 
_userRepositoryJJ #
==JJ$ &
nullJJ' +
)JJ+ ,
{KK 
_userRepositoryLL #
=LL$ %
newLL& )
UserRepositoryLL* 8
(LL8 9
_dbLL9 <
)LL< =
;LL= >
}MM 
returnNN 
_userRepositoryNN &
;NN& '
}OO 
}PP 	
publicRR 
IOrderRepositoryRR 
OrdersRR  &
{SS 	
getTT 
{UU 
ifVV 
(VV 
_orderRepositoryVV $
==VV% '
nullVV( ,
)VV, -
{WW 
_orderRepositoryXX $
=XX% &
newXX' *
OrderRepositoryXX+ :
(XX: ;
_dbXX; >
)XX> ?
;XX? @
}YY 
returnZZ 
_orderRepositoryZZ '
;ZZ' (
}[[ 
}\\ 	
public^^ 
IReviewRepository^^  
Reviews^^! (
{^^) *
get__ 
{`` 
ifaa 
(aa 
_reviewRepositoryaa %
==aa& (
nullaa) -
)aa- .
{bb 
_reviewRepositorycc %
=cc& '
newcc( +
ReviewRepositorycc, <
(cc< =
_dbcc= @
)cc@ A
;ccA B
}dd 
returnee 
_reviewRepositoryee (
;ee( )
}ff 
}gg 	
publicii 
voidii 
Commitii 
(ii 
)ii 
{jj 	
_dbkk 
.kk 
SaveChangeskk 
(kk 
)kk 
;kk 
}ll 	
publicmm 
voidmm 
Disposemm 
(mm 
)mm 
{nn 	
_dboo 
.oo 
Disposeoo 
(oo 
)oo 
;oo 
}pp 	
}qq 
}rr 
]C:\projects\repos\GameStore\src\4 - Infra\GameStore.Infra.Data\Repositories\UserRepository.cs
	namespace 	
	GameStore
 
. 
Infra 
. 
Data 
. 
Repositories +
{		 
public

 

class

 
UserRepository

 
:

  !

Repository

" ,
<

, -
User

- 1
>

1 2
,

2 3
IUserRepository

4 C
{ 
private 
GameStoreContext  
_db! $
;$ %
public 
UserRepository 
( 
GameStoreContext .
db/ 1
)1 2
:3 4
base5 9
(9 :
db: <
)< =
{ 	
_db 
= 
db 
; 
} 	
} 
} 